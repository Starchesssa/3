name: Upward Wave Visualizer

on:
  workflow_dispatch:

jobs:
  render:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Install FFmpeg
        run: |
          sudo apt update
          sudo apt install -y ffmpeg

      - name: Render upward waveform
        run: |
          AUDIO="BOOKS/Temp/TTS/1_INTRO.wav"
          OUT="upward.mp4"

          ffmpeg -i "$AUDIO" \
          -filter_complex "[0:a]aformat=channel_layouts=mono,showwaves=s=720x400:mode=p2p:colors=white" \
          -c:v libx264 -pix_fmt yuv420p \
          -c:a aac -b:a 192k \
          "$OUT" -y

      - name: Upload Artifact
        uses: actions/upload-artifact@v3
        with:
          name: upward-wave
          path: upward.mp4
